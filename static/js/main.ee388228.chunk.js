(this.webpackJsonpcontact_plus=this.webpackJsonpcontact_plus||[]).push([[0],{353:function(e,t,a){e.exports=a.p+"static/media/1.5cf31605.wav"},354:function(e,t,a){e.exports=a.p+"static/media/2.e59b9072.wav"},355:function(e,t,a){e.exports=a.p+"static/media/3.edc2da23.wav"},356:function(e,t,a){e.exports=a.p+"static/media/4.ae1de26d.wav"},357:function(e,t,a){e.exports=a.p+"static/media/5.1cdb9034.wav"},358:function(e,t,a){e.exports=a.p+"static/media/6.9ba7805a.wav"},359:function(e,t,a){e.exports=a.p+"static/media/7.ce7c77b6.wav"},360:function(e,t,a){e.exports=a.p+"static/media/8.281df24a.wav"},361:function(e,t,a){e.exports=a.p+"static/media/9.f25bbf24.wav"},362:function(e,t,a){e.exports=a.p+"static/media/0.96f7c6f1.wav"},363:function(e,t,a){e.exports=a.p+"static/media/star.1b621124.wav"},364:function(e,t,a){e.exports=a.p+"static/media/p.248be4b3.wav"},365:function(e,t,a){e.exports=a.p+"static/media/ring.ac6f9d10.mp3"},397:function(e,t,a){e.exports=a(570)},402:function(e,t,a){},404:function(e,t,a){},570:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(26),c=a.n(s),o=(a(402),a(403),a(404),a(141)),i=a(344),l=a.n(i),u=a(345),d=a(29),m={loggedIn:"true"===sessionStorage.getItem("loggedIn")||!1,isLoading:!1,user:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){default:return e;case"LOGIN_LOADING":return Object(d.a)({},e,{isLoading:!0});case"LOGIN_FAILED":return Object(d.a)({},e,{isLoading:!1,errMess:t.payload});case"LOGIN_SUCCESS":return Object(d.a)({},e,{isLoading:!1,loggedIn:t.payload,errMess:null});case"LOGOUT_SUCCESS":return Object(d.a)({},e,{isLoading:!1,loggedIn:!1,errMess:t.payload,user:null});case"USER_SUCCESS":return Object(d.a)({},e,{isLoading:!1,user:t.payload,errMess:null});case"USER_FAILED":return Object(d.a)({},e,{errMess:t.payload})}},f={isReady:!1,isLogin:!1,isLoading:!1,errMess:null,reasons:[],message:"",currentChannel:null},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){default:return e;case"AGENT_LOADING":return Object(d.a)({},e,{isLoading:!0});case"QLOGIN_FAILED":return Object(d.a)({},e,{isLoading:!1,errMess:t.payload});case"QLOGIN_SUCCESS":return Object(d.a)({},e,{isLoading:!1,isLogin:!0,message:t.payload});case"QLOGOUT_FAILED":return Object(d.a)({},e,{isLoading:!1,errMess:t.payload});case"QLOGOUT_SUCCESS":return Object(d.a)({},e,{isLoading:!1,isLogin:!1});case"READY_FAILED":return Object(d.a)({},e,{isReady:!1,isLoading:!1,errMess:t.payload});case"READY_SUCCESS":return Object(d.a)({},e,{isReady:!0,isLoading:!1,errMess:null,message:t.payload});case"NOTREADY_FAILED":return Object(d.a)({},e,{isReady:!0,isLoading:!1,errMess:t.payload});case"NOTREADY_SUCCESS":return Object(d.a)({},e,{isReady:!1,isLoading:!1,errMess:null});case"REASON_SUCCESS":return Object(d.a)({},e,{reasons:t.payload,isLoading:!1,errMess:null});case"REASON_SUCCESS":return Object(d.a)({},e,{reasons:[],errMess:t.payload,isLoading:!1});case"ISREADY_SUCCESS":return Object(d.a)({},e,{errMess:null,isLoading:!1,isReady:t.payload});case"ISREADY_FAILED":return Object(d.a)({},e,{errMess:t.payload,isLoading:!1});case"GETCHANNEL_SUCCESS":return Object(d.a)({},e,{currentChannel:t.payload});case"GETWORKCODE_FAILED":return Object(d.a)({},e,{currentChannel:null,errMess:t.payload});case"SUBMITWORKCODE_SUCCESS":return Object(d.a)({},e,{message:t.payload});case"SUBMITWORKCODE_FAILED":return Object(d.a)({},e,{errMess:t.payload})}},E={settings:null,errMess:null,isLoading:!1},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){default:return e;case"SYSTEM_LOADING":return Object(d.a)({},e,{isLoading:!0});case"SYSTEM_SUCCESS":return Object(d.a)({},e,{settings:t.payload,isLoading:!1,errMess:null});case"SYSTEM_FAILED":return Object(d.a)({},e,{isLoading:!1,errMess:t.payload})}},y={isLoading:!1,errMess:null,status:[]},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STATUS_LOADING":return Object(d.a)({},e,{isLoading:!0});case"STATUS_FAILED":return Object(d.a)({},e,{isLoading:!1,errMess:t.payload});case"STATUS_SUCCESS":return Object(d.a)({},e,{errMess:null,isLoading:!1,status:t.payload});default:return Object(d.a)({},e)}},S={workcodes:[],isLoading:!1,errMess:null},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){default:return e;case"GETWORKCODE_LOADING":return Object(d.a)({},e,{isLoading:!0});case"GETWORKCODE_SUCCESS":return Object(d.a)({},e,{workcodes:t.payload,isLoading:!1});case"GETWORKCODE_FAILED":return Object(d.a)({},e,{errMess:t.payload})}},j=a(31),C=a(387),v=a(52),L=a(108),I=a(56),A=a(152),w=a.n(A),k="/sanctum/csrf-cookie",_=w.a.create({baseURL:"https://api.contactplus.com",withCredentials:!0,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),D=["Inbound","Outbound","Blended"],T=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t){t(U()),_.post("/logout").then((function(a){t(N(e)),sessionStorage.removeItem("loggedIn")}))}},U=function(){return{type:"LOGIN_LOADING"}},R=function(){return{type:"LOGIN_SUCCESS",payload:!0}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:"LOGOUT_SUCCESS",payload:e}},F=function(e){return{type:"USER_SUCCESS",payload:e}},M=function(e){return{type:"USER_FAILED",payload:e}},x=a(574),G=a(581),z=a(582),P=a(583),B=a(80),W={labelCol:{span:8},wrapperCol:{span:8}},Y={wrapperCol:{offset:8,span:16}},K=Object(I.b)((function(e){return{user:e.user}}),(function(e){return{loginUser:function(t,a){return e(function(e,t){return function(a){a(U()),_.get("/sanctum/csrf-cookie").then((function(n){_.post("/login",{username:e,password:t}).then((function(e){console.log(e),200===e.status?(a(R()),_.get("/api/get-user").then((function(e){200===e.status&&-1!==D.indexOf(e.data.type)?(sessionStorage.setItem("loggedIn",!0),a(R()),a(F(e.data))):a(T(!0))})).catch((function(e){console.log(e)}))):302===e.status&&console.log(e)})).catch((function(e){return a(T())}))}))}}(t,a))}}}))((function(e){var t=Object(n.useState)(""),a=Object(j.a)(t,2),s=(a[0],a[1]),c=Object(n.useState)(""),o=Object(j.a)(c,2),i=(o[0],o[1]),l=Object(n.useState)(null),u=Object(j.a)(l,2),d=(u[0],u[1]),m=Object(v.g)();return Object(n.useEffect)((function(){d(e.user.errMess)}),[e.user.errMess]),Object(n.useEffect)((function(){e.user.loggedIn?(s(""),i(""),m.push("/dashboard")):console.log("what the hell")}),[e.user.loggedIn]),r.a.createElement(x.a,Object.assign({},W,{name:"basic",initialValues:{remember:!0},onFinish:function(t){console.log("Success:",t),e.loginUser(t.username,t.password)},onFinishFailed:function(e){console.log("Failed:",e)}}),e.user.errMess?r.a.createElement(G.a,{status:"403",title:"403",subTitle:"Sorry, you are not authorized to access this page."}):"",r.a.createElement(x.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(z.a,null)),r.a.createElement(x.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(z.a.Password,null)),r.a.createElement(x.a.Item,Object.assign({},Y,{name:"remember",valuePropName:"checked"}),r.a.createElement(P.a,null,"Remember me")),r.a.createElement(x.a.Item,Y,r.a.createElement(B.a,{type:"primary",htmlType:"submit"},"Submit")))})),H=a(116),q=a(586),Q={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},V={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},J=function(){var e=x.a.useForm(),t=Object(j.a)(e,1)[0];return r.a.createElement(x.a,Object.assign({},Q,{form:t,name:"register",onFinish:function(e){console.log("Received values of form: ",e)},initialValues:{residence:["zhejiang","hangzhou","xihu"],prefix:"86"},scrollToFirstError:!0}),r.a.createElement(x.a.Item,{name:"email",label:"E-mail",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}]},r.a.createElement(z.a,null)),r.a.createElement(x.a.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please input your password!"}],hasFeedback:!0},r.a.createElement(z.a.Password,null)),r.a.createElement(x.a.Item,{name:"confirm",label:"Confirm Password",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("password")!==a?Promise.reject("The two passwords that you entered do not match!"):Promise.resolve()}}}]},r.a.createElement(z.a.Password,null)),r.a.createElement(x.a.Item,{name:"username",label:r.a.createElement("span",null,"Username\xa0",r.a.createElement(H.a,{title:"What do you want others to call you?"},r.a.createElement(q.a,null))),rules:[{required:!0,message:"Please input your username!",whitespace:!0}]},r.a.createElement(z.a,null)),r.a.createElement(x.a.Item,V,r.a.createElement(B.a,{type:"primary",htmlType:"submit"},"Register")))},X=a(572),$=a(234),Z=a(578),ee=a(571),te=a(577),ae=a(388),ne=a(576),re=a(147),se=a(88),ce=a(585),oe=a(575),ie=a(580),le=a(588),ue=a(589),de=a(590),me=a(591),pe=a(233),fe=a(352),ge=a.n(fe),Ee=a(353),be=a.n(Ee),ye=a(354),Oe=a.n(ye),Se=a(355),he=a.n(Se),je=a(356),Ce=a.n(je),ve=a(357),Le=a.n(ve),Ie=a(358),Ae=a.n(Ie),we=a(359),ke=a.n(we),_e=a(360),De=a.n(_e),Te=a(361),Ue=a.n(Te),Re=a(362),Ne=a.n(Re),Fe=a(363),Me=a.n(Fe),xe=a(364),Ge=a.n(xe),ze=a(365),Pe=a.n(ze),Be=a(51);w.a.defaults.withCredentials=!0;var We=function(){return function(e){e(lt()),_.get(k).then((function(){_.post("/api/agent/is-ready").then((function(t){200===t.status?e(Xe(t.data)):e($e("Failed to fetch agent status"))})).catch((function(e){return console.log(e)}))}))}},Ye=function(e){return function(t){t(lt()),_.get(k).then((function(a){_.post("/api/agent/unpause",{reason:e}).then((function(e){var a;200===e.status?(console.log(e),t(ct(null===(a=e.data.data)||void 0===a?void 0:a.message)),t(We())):console.log(e)})).catch((function(e){return t(st(e.response.data))}))}))}},Ke=function(e){return function(t){console.log(e),t(lt()),_.get(k).then((function(a){_.post("/api/agent/pause",{reason:e}).then((function(e){200===e.status?(t(nt()),t(We())):console.log(e)})).catch((function(e){return t(rt(e))}))}))}},He=function(){return function(e){e(lt()),_.get(k).then((function(t){_.get("/api/pause-reason").then((function(t){200===t.status?e(ot(t.data.data)):console.log(t)})).catch((function(t){return e(it(t.response.data))}))}))}},qe=function(e){return{type:"GETCHANNEL_SUCCESS",payload:e}},Qe=function(e){return{type:"GETCHANNEL_FAILED",payload:e}},Ve=function(e){return{type:"SUBMITWORKCODE_SUCCESS",payload:e}},Je=function(e){return{type:"SUBMITWORKCODE_FAILED",payload:e}},Xe=function(e){return{type:"ISREADY_SUCCESS",payload:e}},$e=function(e){return{type:"ISREADY_FAILED",payload:e}},Ze=function(e){return{type:"QLOGIN_SUCCESS",payload:e}},et=function(e){return{type:"QLOGIN_FAILED",payload:e}},tt=function(){return{type:"QLOGOUT_SUCCESS"}},at=function(e){return{type:"QLOGOUT_FAILED",payload:e}},nt=function(){return{type:"NOTREADY_SUCCESS"}},rt=function(e){return{type:"NOTREADY_FAILED",payload:e}},st=function(e){return{type:"READY_FAILED",payload:e}},ct=function(e){return{type:"READY_SUCCESS",payload:e}},ot=function(e){return{type:"REASON_SUCCESS",payload:e}},it=function(e){return{type:"READY_FAILED",error:e}},lt=function(){return{type:"AGENT_LOADING"}},ut=a(573),dt=a(579),mt=function(){return function(e){e(pt()),_.get(k).then((function(t){_.post("/api/agent/status").then((function(t){var a;200===t.status?e(ft(null===(a=t.data)||void 0===a?void 0:a.data)):console.log(t)})).catch((function(t){return e(gt(t.response.data))}))}))}},pt=function(){return{type:"STATUS_LOADING"}},ft=function(e){return{type:"STATUS_SUCCESS",payload:e}},gt=function(e){return{type:"STATUS_FAILED",payload:e}},Et={width:"33%",textAlign:"center"};var bt=function(e){var t=e.stats,a=e.title,n=(Object(I.c)(),Object(I.d)((function(e){return e.stats})));return r.a.createElement(ee.a,{size:"large",spinning:n.isLoading},r.a.createElement(ut.a,{style:{textAlign:"center"},title:a,bordered:!1},t&&Object.keys(t).map((function(e,a){return r.a.createElement(ut.a.Grid,{key:a,style:Et},r.a.createElement(dt.a,{formatter:function(e){return r.a.createElement("span",{style:{fontSize:"12px"}},e)},title:e,value:t[e]}))}))))},yt=a(584),Ot=a(587),St=function(e){var t=e.onCall,a=e.onKeyPadClick,n=e.onMuteClick,s=e.onHoldClick,c=e.onHold,o=e.onMute,i=e.agentMode;return r.a.createElement(yt.b,{direction:"vertical"},!i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(re.a,null,r.a.createElement(yt.b,{size:20,direction:"horizontal"},["1","2","3"].map((function(e,t){return r.a.createElement(B.a,{onClick:function(){return a(e)},key:t,size:"large",type:"primary",shape:"circle-outline"},e)})))),r.a.createElement(re.a,null,r.a.createElement(yt.b,{size:20,direction:"horizontal"},["4","5","6"].map((function(e,t){return r.a.createElement(B.a,{onClick:function(){return a(e)},key:t,size:"large",type:"primary",shape:"circle-outline"},e)})))),r.a.createElement(re.a,null,r.a.createElement(yt.b,{size:20,direction:"horizontal"},["7","8","9"].map((function(e,t){return r.a.createElement(B.a,{onClick:function(){return a(e)},key:t,size:"large",type:"primary",shape:"circle-outline"},e)})))),r.a.createElement(re.a,null,r.a.createElement(yt.b,{size:20,direction:"horizontal"},["#","0","*"].map((function(e,t){return r.a.createElement(B.a,{onClick:function(){return a(e)},key:t,size:"large",type:"primary",shape:"circle-outline"},e)}))))),r.a.createElement(re.a,{justify:"center"},r.a.createElement(yt.b,{size:20,direction:"horizontal"},r.a.createElement(B.a,{onClick:n,disabled:!t,icon:r.a.createElement(Ot.a,null),shape:"circle",size:"large",type:o?"danger":"primary"}),r.a.createElement(B.a,{onClick:e.onDialClick,style:{backgroundColor:t?"#FF5252":"#4CAF50"},shape:"circle",icon:r.a.createElement(le.a,{twoToneColor:t?"#FF5252":"#4CAF50"}),size:"large"}),r.a.createElement(B.a,{onClick:s,disabled:!t,icon:r.a.createElement(ue.a,null),shape:"circle",size:"large",type:c?"danger":"primary"}))))},ht=function(e){var t=e.setVisible,a=e.visible,n=e.channel,s=Object(I.c)(),c=Object(I.d)((function(e){return e.workcode})).workcodes,o=function(e){s(function(e,t){return function(a){a(Ke("ACW_START")),_.get(k).then((function(n){_.post("/api/agent/workcode",{code:e,channel:t}).then((function(e){a(Ve(e.data)),a(Ye("ACW_END"))})).catch((function(e){return a(Je(e.response.data))}))}))}}(e.workcode,n)),t(!1)},i=x.a.useForm(),l=Object(j.a)(i,1)[0];return r.a.createElement(te.a,{visible:a&&n,title:"Submit Work Code",okText:"Create",centered:!0,closable:!1,onOk:function(){l.validateFields().then((function(e){l.resetFields(),o(e)})).catch((function(e){console.log("Validate Failed:",e)}))}},r.a.createElement(x.a,{form:l,layout:"horizontal",name:"form_in_modal"},r.a.createElement(x.a.Item,{name:"workcode",label:"Workcode",rules:[{required:!0,message:"Please input the workcode!"}]},r.a.createElement(ne.a,null,c.map((function(e,t){return r.a.createElement(ne.a.Option,{key:e.id,value:e.name},e.name)}))))))},jt={marginBottom:"10px"};function Ct(e){var t=[new Audio(Ne.a),new Audio(be.a),new Audio(Oe.a),new Audio(he.a),new Audio(Ce.a),new Audio(Le.a),new Audio(Ae.a),new Audio(ke.a),new Audio(De.a),new Audio(Ue.a),new Audio(Ge.a),new Audio(Me.a)],a=Object(n.useState)(new Audio(Pe.a)),s=Object(j.a)(a,1)[0],c=Object(I.c)(),o=Object(I.d)((function(e){return e.agent})),i=Object(I.d)((function(e){return e.stats})),l=o.reasons.map((function(e){return e.name}));Object(I.d)((function(e){return e.workcode}));Object(n.useEffect)((function(){c((function(e){e(U()),_.get(k).then((function(t){_.get("/api/get-user").then((function(t){200===t.status&&-1!==D.indexOf(t.data.type)?e(F(t.data)):e(T(!0))})).catch((function(t){401===t.response.status?e(T()):e(M(t.response.data))}))}))}))}),[]);var u={onConnect:function(){xe(!0),ca("success","UA has been connected")},onDisconnect:function(e){xe(!1),ca("error","UA has been disconnected")},onRegister:function(e){},onInvite:function(e){Ct(e),ut(!0),gt(e.remoteIdentity.uri.user),e.delegate={onRefer:function(e){}},e.stateChange.addListener((function(t){switch(t){case Be.SessionState.Establishing:break;case Be.SessionState.Established:console.info("Session is established"),ut(!1),Xe(!0),st("CALL CONNECTED"),na(e),c((function(e){_.get(k).then((function(t){_.post("/api/agent/channel").then((function(t){200===t.status&&e(qe(t.data))})).catch((function(t){return e(Qe(t.response.data))}))}))}));break;case Be.SessionState.Terminated:console.info("Session has terminated"),ut(!1),Xe(!1),gt(""),Ct(!1),st("CALL DISCONNECTED"),g(!0),ra()}}));var t={sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1}}};te.a.confirm({title:"Incoming call",icon:r.a.createElement(le.a,null),content:e.remoteIdentity.uri.user,okText:"Accept",cancelText:"Reject",onOk:function(){e.accept(t)},onCancel:function(){e.reject()}})}},d=function(e){switch(e){default:break;case Be.RegistererState.Registered:_e(!0),ca("success","UA has been registered");break;case Be.RegistererState.Unregistered:_e(!1),ca("error","UA has been unregistered")}},m=Object(n.useState)(!1),p=Object(j.a)(m,2),f=p[0],g=p[1],E=Object(n.useState)(null),b=Object(j.a)(E,2),y=b[0],O=b[1],S=Object(n.useState)(null),h=Object(j.a)(S,2),C=h[0],v=h[1],L=Object(n.useState)(null),A=Object(j.a)(L,2),w=(A[0],A[1]),R=Object(n.useState)(null),N=Object(j.a)(R,2),x=N[0],G=N[1],P=Object(n.useState)(null),W=Object(j.a)(P,2),Y=W[0],K=W[1],H=Object(n.useState)(null),q=Object(j.a)(H,2),Q=q[0],V=q[1],J=Object(n.useState)(!1),X=Object(j.a)(J,2),$=X[0],Z=X[1],fe=Object(n.useState)(!1),Ee=Object(j.a)(fe,2),ye=Ee[0],Se=Ee[1];Object(n.useEffect)((function(){if(e.system.settings&&e.user.user){O(e.system.settings.server_address),G(e.user.user.name),v(e.user.user.auth_username),w(e.user.user.type),Z("Inbound"===e.user.user.type),Se("Blended"===e.user.user.type);var t=new Be.UserAgent({authorizationUsername:e.user.user.auth_username,authorizationPassword:e.user.user.auth_password,transportOptions:{server:"wss://".concat(e.system.settings.server_address,":").concat(e.system.settings.wss_port,"/ws")},uri:Be.UserAgent.makeURI("sip:".concat(e.user.user.auth_username,"@").concat(e.system.settings.server_address)),delegate:u,logLevel:"error"}),a=new Be.Registerer(t);K(t),V(a),console.log("Registering UA..."),t.start(),a.stateChange.addListener(d)}return function(){Q&&Q.stateChange.removeListener(d)}}),[e.system.settings,e.user.user]);var je="",ve=Object(n.useState)(!1),Ie=Object(j.a)(ve,2),we=Ie[0],_e=Ie[1],Te=Object(n.useState)(!1),Re=Object(j.a)(Te,2),Fe=Re[0],xe=Re[1],ze=Object(n.useState)(!1),Ve=Object(j.a)(ze,2),Je=Ve[0],Xe=Ve[1],$e=Object(n.useState)("DISCONNECTED"),nt=Object(j.a)($e,2),rt=nt[0],st=nt[1],ct=Object(n.useState)(!1),ot=Object(j.a)(ct,2),it=ot[0],ut=ot[1],dt=Object(n.useState)(""),pt=Object(j.a)(dt,2),ft=pt[0],gt=pt[1],Et=Object(n.useState)(!1),yt=Object(j.a)(Et,2),Ot=yt[0],Ct=yt[1],vt=Object(n.useState)(!1),Lt=Object(j.a)(vt,2),It=(Lt[0],Lt[1]),At=Object(n.useState)(""),wt=Object(j.a)(At,2),kt=(wt[0],wt[1]),_t=Object(n.useState)(!1),Dt=Object(j.a)(_t,2),Tt=Dt[0],Ut=Dt[1],Rt=Object(n.useState)(!1),Nt=Object(j.a)(Rt,2),Ft=Nt[0],Mt=Nt[1],xt=Object(n.useState)(!1),Gt=Object(j.a)(xt,2),zt=Gt[0],Pt=Gt[1],Bt=Object(n.useState)(""),Wt=Object(j.a)(Bt,2),Yt=Wt[0],Kt=Wt[1],Ht=Object(n.useState)("00:00:00"),qt=Object(j.a)(Ht,2),Qt=qt[0],Vt=qt[1],Jt=Object(n.useState)(null),Xt=Object(j.a)(Jt,2),$t=Xt[0],Zt=Xt[1],ea=Object(n.useRef)(),ta=Object(n.useState)(new MediaStream),aa=Object(j.a)(ta,1)[0];Object(n.useEffect)((function(){o.message&&ca("info",o.message)}),[o.message]),Object(n.useEffect)((function(){c(We()),c(mt());var e=setInterval((function(){c(mt())}),3e4);return function(){return clearInterval(e)}}),[]);var na=function(e){e.sessionDescriptionHandler.peerConnection.getReceivers().forEach((function(e){e.track&&aa.addTrack(e.track)})),ea.current.srcObject=aa,ea.current.play()},ra=function(){ea.current.srcObject=null,ea.current.pause()},sa=function(e){t[e].play()};Object(n.useEffect)((function(){t.forEach((function(e,t){e.load(),e.loop=!1})),s.load(),s.loop=!0}),[]),Object(n.useEffect)((function(){if(Je){var e=0,t=setInterval((function(){e++,Vt(new Date(1e3*e).toISOString().substr(11,8))}),1e3);Zt(t)}else clearInterval($t);return function(){return clearInterval($t)}}),[Je]),Object(n.useEffect)((function(){it?(s.loop=!0,s.play()):(s.pause(),s.currentTime=0,te.a.destroyAll())}),[it]);var ca=function(e,t){ae.a[e]({message:"Notification",description:t})},oa=function(e){var t={sessionDescriptionHandlerModifiers:[Be.Web.holdModifier]};e&&e.invite(t)},ia=function(e){e&&e.invite({sessionDescriptionHandlerModifiers:[]})};return r.a.createElement(ee.a,{spinning:o.isLoading},r.a.createElement(ge.a,{handleKeys:["0","1","2","3","4","5","6","7","8","9","shift+3","*","shift+8","backspace"],onKeyEvent:function(e,t){switch(e){default:break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":sa(e),t.target===document.getElementsByTagName("body")[0]&&Kt(Yt+e);break;case"shift+8":case"*":sa(11),t.target===document.getElementsByTagName("body")[0]&&Kt(Yt+"*");break;case"shift+3":sa(10),t.target===document.getElementsByTagName("body")[0]&&Kt(Yt+"#");break;case"backspace":t.target===document.getElementsByTagName("body")[0]&&Kt(Yt.slice(0,-1))}},handleFocusableElements:!0}),r.a.createElement(ht,{setVisible:g,channel:o.currentChannel,visible:f}),r.a.createElement(re.a,{gutter:20},r.a.createElement(se.a,{xs:24,lg:8,style:jt},r.a.createElement(bt,{title:"Queue Stats",stats:i.status[0]})),r.a.createElement(se.a,{style:jt,xs:24,lg:{span:8}},r.a.createElement(re.a,{align:"middle",style:{marginBottom:10},justify:"space-between"},r.a.createElement(se.a,null,r.a.createElement(B.a,{size:"small",onClick:function(){o.isReady?te.a.confirm({title:"Specify Reason",centered:!0,content:r.a.createElement(ne.a,{onSelect:function(e){return je=e},style:{width:"100%"},defaultValue:l[0]},l.map((function(e,t){return r.a.createElement(ne.a.Option,{value:e,key:t},e)}))),onOk:function(){c(Ke(je))},onCancel:function(){}}):c(Ye())},danger:!o.isReady,type:"primary",shape:"round",icon:r.a.createElement(ue.a,null)},o.isReady?"Not-Ready":"Ready")),r.a.createElement(se.a,null,r.a.createElement(B.a,{size:"small",onClick:function(){Q.state===Be.RegistererState.Registered?Q.unregister().then((function(e){console.info("UA unregistered"),($||ye)&&c((function(e){e(lt()),_.get(k).then((function(t){_.post("/api/agent/logout").then((function(t){200===t.status?e(tt()):console.log(t)})).catch((function(t){return e(at(t.response.data))}))}))}))})):Q.register().then((function(e){console.info("UA registered"),($||ye)&&c((function(e){e(lt()),_.get(k).then((function(t){_.post("/api/agent/login").then((function(t){var a,n;200===t.status?(console.log(t),e(Ze(null===(a=t.data)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)),e(He())):console.log(t)})).catch((function(t){return e(et(t.response.data))}))}))}))}))},danger:!we,type:"primary",shape:"round",icon:r.a.createElement(de.a,{twoToneColor:"#52c41a"})},we?"Unregister":"Register"))),r.a.createElement("div",{style:{marginBottom:10}},r.a.createElement(ce.a,{icon:r.a.createElement(me.a,null),color:Fe?"success":"error"},Fe?"connected":"disconnected"),r.a.createElement(ce.a,{style:{float:"right",marginRight:"0px"},icon:r.a.createElement(me.a,null),color:we?"success":"error"},we?"registered":"unregistered")),r.a.createElement("div",{style:{marginBottom:10}},r.a.createElement(oe.a.Text,{keyboard:!0,strong:!0},x),r.a.createElement(oe.a.Text,{strong:!0,style:{float:"right"},keyboard:!0},C)),Je&&r.a.createElement(r.a.Fragment,null,r.a.createElement(re.a,{style:{marginBottom:10},gutter:[10,0],justify:"center"},r.a.createElement(se.a,null,r.a.createElement(ce.a,{color:Je?"success":"error"},rt))),r.a.createElement(re.a,{style:{marginBottom:10},gutter:[5,10],justify:"center"},r.a.createElement(oe.a.Text,{code:!0,strong:!0},Qt))),Ft||zt?r.a.createElement(re.a,{style:{marginBottom:10},gutter:[5,10],justify:"center"},Ft&&r.a.createElement(se.a,null,r.a.createElement(ie.a,{icon:r.a.createElement(pe.b,null),size:"large"})),zt&&r.a.createElement(se.a,null,r.a.createElement(ie.a,{icon:r.a.createElement(pe.a,null),size:"large"}))):"",r.a.createElement(re.a,{justify:"center"},r.a.createElement(se.a,{style:{marginBottom:10},lg:24},r.a.createElement(z.a,{disabled:Je||$,onChange:function(e){return Kt(e.target.value)},value:Yt||ft,autoFocus:!0,size:"large",placeholder:"Phone Number Here",prefix:r.a.createElement(le.a,null)})),r.a.createElement(se.a,null,r.a.createElement("audio",{ref:ea}),r.a.createElement(St,{agentMode:$,onHold:Ft,onMute:zt,onMuteClick:function(){Pt(!zt);var e=(Ot||Tt).sessionDescriptionHandler.peerConnection.getSenders();e.length&&e.forEach((function(e){e.track&&(e.track.enabled=zt)}))},onHoldClick:function(){Ft?(Ot?ia(Ot):Tt&&ia(Tt),Mt(!1)):(Ot?oa(Ot):Tt&&oa(Tt),Mt(!0))},onKeyPadClick:function(e){switch(e){default:break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":sa(e),Kt(Yt+e);break;case"*":sa(11),Kt(Yt+e);break;case"#":sa(10),Kt(Yt+"#")}},onDialClick:function(){var e=Ot||Tt;if(e)e instanceof Be.Inviter&&e.state===Be.SessionState.Establishing?e.cancel():(e instanceof Be.Invitation&&(e.state,Be.SessionState.Established),e.bye());else if(!$){var t=Be.UserAgent.makeURI("sip:".concat(Yt,"@").concat(y)),a=new Be.Inviter(Y,t);a.stateChange.addListener((function(e){switch(console.log("Session state changed to ".concat(e)),e){case Be.SessionState.Initial:case Be.SessionState.Establishing:break;case Be.SessionState.Established:st("CALL CONNECTED"),na(a);break;case Be.SessionState.Terminating:case Be.SessionState.Terminated:te.a.destroyAll(),It(!1),Xe(!1),kt(""),Ut(!1),st("CALL DISCONNECTED"),ra();break;default:throw new Error("Unknown session state.")}})),a.invite(),Ut(a),It(!0),Xe(!0)}},onCall:Je})))),r.a.createElement(se.a,{xs:24,lg:8},r.a.createElement(bt,{title:"Agent Stats",stats:i.status[1]}))))}var vt=function(){return{type:"SYSTEM_LOADING"}},Lt=function(e){return{type:"SYSTEM_SUCCESS",payload:e}},It=function(e){return{type:"SYSTEM_FAILED",payload:e}},At=function(e){return{type:"GETWORKCODE_SUCCESS",payload:e}},wt=function(e){return{type:"GETWORKCODE_FAILED",payload:e}};function kt(e){var t=e.children,a=Object(C.a)(e,["children"]),s=Object(I.d)((function(e){return e.user})),c=Object(n.useState)("/sign-in"),o=Object(j.a)(c,1)[0];return r.a.createElement(v.b,Object.assign({},a,{render:function(e){var a=e.location;return s.loggedIn?t:r.a.createElement(v.a,{to:{pathname:o,state:{from:a}}})}}))}var _t=function(){var e=X.a.Header,t=X.a.Content,a=X.a.Footer,s=Object(I.d)((function(e){return e.user})),c=Object(I.d)((function(e){return e.system})),o=Object(I.c)(),i=Object(v.h)();return Object(n.useEffect)((function(){s.loggedIn&&(console.log("happening"),o((function(e){e(vt()),_.get(k).then((function(t){_.get("/api/system-setting").then((function(t){200===t.status?e(Lt(t.data.data)):console.log(t)})).catch((function(t){return e(It(t.response.data))}))}))})),o((function(e){_.get(k).then((function(){_.get("/api/workcode").then((function(t){200===t.status?e(At(t.data.data)):e(wt("Work codes Fetch failed"))})).catch((function(t){return e(wt(t.response.data))}))}))})))}),[s.loggedIn]),r.a.createElement(X.a,{className:"layout"},r.a.createElement(e,{hasSider:!1,style:{backgroundColor:"#fff"}},r.a.createElement($.a,{inlineCollapsed:!1,theme:"light",mode:"horizontal",defaultSelectedKeys:["1"],selectedKeys:[i.pathname]},r.a.createElement($.a.Item,null,r.a.createElement(L.b,{to:"/"},r.a.createElement("div",{className:"logo"}))),r.a.createElement($.a.Item,{key:"/sign-in"},r.a.createElement(L.b,{to:"/sign-in"},"Login")),r.a.createElement($.a.Item,{key:"/sign-up"},r.a.createElement(L.b,{to:"/sign-up"},"Register")),r.a.createElement($.a.Item,{key:"/dashboard"},r.a.createElement(L.b,{to:"/dashboard"},"App")),r.a.createElement($.a.Item,{key:"/logout"},r.a.createElement(B.a,{type:"link",onClick:function(){o(T())}},"Logout")))),r.a.createElement(t,{style:{padding:"0 10px"}},r.a.createElement(Z.a,{style:{margin:"16px 0"}},r.a.createElement(Z.a.Item,null,"App"),r.a.createElement(Z.a.Item,null,"Dashboard")),r.a.createElement(ee.a,{spinning:s.isLoading||c.isLoading},r.a.createElement("div",{className:"site-layout-content"},r.a.createElement(v.d,null,r.a.createElement(v.b,{exact:!0,path:"/",component:K}),r.a.createElement(v.b,{path:"/sign-in",component:K}),r.a.createElement(v.b,{path:"/sign-up",component:J}),r.a.createElement(kt,{path:"/dashboard"},r.a.createElement(Ct,{user:s,system:c})))))),r.a.createElement(a,{style:{textAlign:"center"}},"Contact Plus \xa9 2020 Created by ",r.a.createElement("a",{href:"mailto:abdullah_basit@telecard.com.pk"},"Dev Team @ Telecard")))},Dt=Object(o.d)(Object(o.c)({user:p,agent:g,system:b,stats:O,workcode:h}),Object(o.a)(u.a,l.a));var Tt=function(){return r.a.createElement(I.a,{store:Dt},r.a.createElement(L.a,null,r.a.createElement(_t,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(Tt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[397,1,2]]]);
//# sourceMappingURL=main.ee388228.chunk.js.map